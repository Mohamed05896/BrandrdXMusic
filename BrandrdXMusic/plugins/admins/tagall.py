from BrandrdXMusic import app 
import asyncio
import random
from pyrogram import Client, filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.errors import UserNotParticipant
from pyrogram.types import ChatPermissions

spam_chats = []

EMOJI = [ "ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹", "ğŸ§šğŸŒ¸ğŸ§‹ğŸ¬ğŸ«–", "ğŸ¥€ğŸŒ·ğŸŒ¹ğŸŒºğŸ’", "ğŸŒ¸ğŸŒ¿ğŸ’®ğŸŒ±ğŸŒµ", "â¤ï¸ğŸ’šğŸ’™ğŸ’œğŸ–¤",
          "ğŸ’“ğŸ’•ğŸ’ğŸ’—ğŸ’–", "ğŸŒ¸ğŸ’ğŸŒºğŸŒ¹ğŸ¦‹", "ğŸ”ğŸ¦ªğŸ›ğŸ²ğŸ¥—", "ğŸğŸ“ğŸ’ğŸ‘ğŸŒ¶ï¸", "ğŸ§‹ğŸ¥¤ğŸ§‹ğŸ¥›ğŸ·",
          "ğŸ¬ğŸ­ğŸ§ğŸ‚ğŸ¡", "ğŸ¨ğŸ§‰ğŸºâ˜•ğŸ»", "ğŸ¥ªğŸ¥§ğŸ¦ğŸ¥ğŸš", "ğŸ«–â˜•ğŸ¹ğŸ·ğŸ¥›", "â˜•ğŸ§ƒğŸ©ğŸ¦ğŸ™",
          "ğŸğŸŒ¾ğŸ’®ğŸ‚ğŸŒ¿", "ğŸŒ¨ï¸ğŸŒ¥ï¸â›ˆï¸ğŸŒ©ï¸ğŸŒ§ï¸", "ğŸŒ·ğŸµï¸ğŸŒ¸ğŸŒºğŸ’", "ğŸ’®ğŸŒ¼ğŸŒ»ğŸ€ğŸ", "ğŸ§ŸğŸ¦¸ğŸ¦¹ğŸ§™ğŸ‘¸",
          "ğŸ§…ğŸ ğŸ¥•ğŸŒ½ğŸ¥¦", "ğŸ·ğŸ¹ğŸ­ğŸ¨ğŸ»â€â„ï¸", "ğŸ¦‹ğŸ‡ğŸ€ğŸˆğŸˆâ€â¬›", "ğŸŒ¼ğŸŒ³ğŸŒ²ğŸŒ´ğŸŒµ", "ğŸ¥©ğŸ‹ğŸğŸˆğŸ‡",
          "ğŸ´ğŸ½ï¸ğŸ”ªğŸ¶ğŸ¥ƒ", "ğŸ•ŒğŸ°ğŸ©â›©ï¸ğŸ©", "ğŸ‰ğŸŠğŸˆğŸ‚ğŸ€", "ğŸª´ğŸŒµğŸŒ´ğŸŒ³ğŸŒ²", "ğŸ„ğŸ‹ğŸğŸ‘ğŸ",
          "ğŸ¦…ğŸ¦œğŸ•Šï¸ğŸ¦¤ğŸ¦¢", "ğŸ¦¤ğŸ¦©ğŸ¦šğŸ¦ƒğŸ¦†", "ğŸ¬ğŸ¦­ğŸ¦ˆğŸ‹ğŸ³", "ğŸ”ğŸŸğŸ ğŸ¡ğŸ¦", "ğŸ¦©ğŸ¦€ğŸ¦‘ğŸ™ğŸ¦ª",
          "ğŸ¦ğŸ¦‚ğŸ•·ï¸ğŸ•¸ï¸ğŸš", "ğŸ¥ªğŸ°ğŸ¥§ğŸ¨ğŸ¨", " ğŸ¥¬ğŸ‰ğŸ§ğŸ§‡" ]

TAGMES = [ 
    "**ÙŠØ§ Ø£Ù‡Ù„ Ø§Ù„Ø¬Ø±ÙˆØ¨ØŒ Ø¥Ù†ØªÙˆØ§ ÙÙŠÙ†ØŸ Ù…Ù†ÙˆØ±ÙŠÙ† ÙˆØ§Ù„Ù„Ù‡ ğŸ¤—**",
    "**Ø­Ø¯ Ù‡Ù†Ø§ ÙˆÙ„Ø§ Ù†Ù…ØªÙˆØ§ØŸ Ø§Ø¸Ù‡Ø±ÙˆØ§ ÙˆØ¨Ø§Ù†ÙˆØ§ ğŸ˜Š**",
    "**ÙŠØ§ Ø¬Ù…Ø§Ø¹Ø© ØªØ¹Ø§Ù„ÙˆØ§ Ø§Ù„ÙƒÙˆÙ„ (VC) Ù†Ø¯Ø±Ø¯Ø´ Ø´ÙˆÙŠØ© ğŸ˜ƒ**",
    "**Ø£ÙƒÙ„ØªÙˆØ§ ÙˆÙ„Ø§ Ù„Ø³Ø©ØŸ Ø¨Ø§Ù„Ù‡Ù†Ø§ ÙˆØ§Ù„Ø´ÙØ§ Ù…Ù‚Ø¯Ù…Ù‹Ø§ ğŸ¥²**",
    "**ÙŠØ§ Ø±Ø¨ Ø§Ù„ÙƒÙ„ ÙŠÙƒÙˆÙ† Ø¨Ø®ÙŠØ± ÙˆØ¨Ø£Ø­Ø³Ù† Ø­Ø§Ù„ ğŸ¥º**",
    "**ÙˆØ­Ø´ØªÙˆÙ†Ø§ ÙˆØ§Ù„Ù„Ù‡ØŒ ÙÙŠÙ† Ø·Ù„ØªÙƒÙ… Ø§Ù„Ø­Ù„ÙˆØ©ØŸ ğŸ¤­**",
    "**ÙŠØ§ Ø³ÙƒØ±Ø©ØŒ Ø·Ù…Ù†Ø§ Ø¹Ù„ÙŠÙƒ Ø£Ø®Ø¨Ø§Ø±Ùƒ Ø¥ÙŠÙ‡ØŸ ğŸ¤¨**",
    "**Ù…Ù…ÙƒÙ† Ù†ØªØ¹Ø±Ù ÙˆÙ„Ø§ Ø¥Ø­Ù†Ø§ Ø¶ÙŠÙˆÙ ØªÙ‚Ø§Ù„ØŸ ğŸ™‚**",
    "**ÙØ·Ø±ØªÙˆØ§ ÙˆÙ„Ø§ Ù„Ø³Ø© ÙŠØ§ ÙƒØ³Ù„Ø§Ù†ÙŠÙ†ØŸ ğŸ˜‹**",
    "**Ø§Ù„Ø¬Ø±ÙˆØ¨ Ø¯Ù‡ Ù…Ø­ØªØ§Ø¬ Ø´ÙˆÙŠØ© ÙØ±ÙØ´Ø©ØŒ Ø¥ÙŠÙ‡ Ø§Ù„Ø³ÙƒÙˆØª Ø¯Ù‡ØŸ ğŸ˜**",
    "**Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¬Ø±ÙˆØ¨ ÙÙŠÙ†ØŸ Ø­Ø¯ ÙŠÙ„Ø­Ù‚Ù†Ø§ Ø¨Ø£ØºÙ†ÙŠØ© Ø­Ù„ÙˆØ© ğŸ˜•**",
    "**Ù…Ù† Ø£ÙŠ Ø¨Ù„Ø¯ Ù…Ù†ÙˆØ±Ù†Ø§ ÙŠØ§ ØºØ§Ù„ÙŠØŸ ğŸ™ƒ**",
    "**ÙŠØ§ Ù…Ø³Ø§Ø¡ Ø§Ù„Ø¬Ù…Ø§Ù„ Ø¹Ù„Ù‰ Ø£Ø­Ù„Ù‰ Ù†Ø§Ø³ ğŸ˜›**",
    "**ÙŠØ§ ØµØ¨Ø§Ø­ Ø§Ù„ÙÙ„ ÙˆØ§Ù„ÙŠØ§Ø³Ù…ÙŠÙ† ğŸ˜œ**",
    "**ÙƒÙ†Øª Ø¹Ø§ÙŠØ² Ø£Ù‚ÙˆÙ„Ùƒ Ø¥Ù†Ùƒ Ø´Ø®Øµ Ù…Ø­ØªØ±Ù… Ø¬Ø¯Ø§Ù‹ ğŸ™‚**",
    "**Ù†ÙˆØ±ØªÙ†Ø§ ÙŠØ§ Ø¨Ø·Ù„ØŒ ÙˆØ¬ÙˆØ¯Ùƒ Ø¨ÙŠÙØ±Ù‚ Ù…Ø¹Ø§Ù†Ø§ ğŸ˜º**",
    "**ÙŠØ§ ÙˆØ§Ø¯ ÙŠØ§ ØªÙ‚ÙŠÙ„ØŒ Ø¹Ø¨Ø±Ù†Ø§ Ø¨ÙƒÙ„Ù…Ø© ğŸ˜‡**",
    "**ÙŠØ§ Ø¹Ø³Ù„ØŒ Ù…Ø§ ÙƒÙØ§ÙŠØ© Ù†ÙˆÙ… Ø¨Ù‚Ù‰ ÙˆØ§ØµØ­Ù‰ Ù„ÙŠÙ†Ø§ ğŸ˜†**",
    "**Ù…Ù†ÙˆØ± Ø§Ù„Ø¯Ù†ÙŠØ§ Ø¨Ø·Ù„ØªÙƒ ÙˆØ§Ù„Ù„Ù‡ ğŸ˜‰**",
    "**ÙŠØ§ Ø±Ø¨ Ø¯Ø§ÙŠÙ…Ø§ Ø¶Ø­ÙƒØªÙƒ Ù…Ø¨Ø±ÙˆØ²Ø© ÙˆØ´Ùƒ â¤**",
    "**Ø¥Ù†Øª Ø¹Ø§Ø±Ù Ø¥Ù†Ùƒ ØºØ§Ù„ÙŠ Ø¹Ù„ÙŠÙ†Ø§ØŸ â£ï¸**",
    "**Ù„Ùˆ Ø­Ø¯ Ø²Ø¹Ù„Ùƒ Ù‚ÙˆÙ„ÙŠ Ø¨Ø³ ÙˆØ£Ù†Ø§ Ø£Ø±ÙˆÙ‚Ù„Ùƒ Ø§Ù„Ø´Ø§Øª ğŸ¤**",
    "**Ø®Ù„ÙŠÙƒ Ø¯Ø§ÙŠÙ…Ø§ Ø±Ø§ÙŠÙ‚ ÙˆÙ…ÙƒØ¨Ø± Ø¯Ù…Ø§ØºÙƒ ğŸ¤**",
    "**Ø¥Ù†Øª Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù„ÙŠ Ù…Ù„ÙˆØ´ Ø¨Ø¯ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¬Ø±ÙˆØ¨ Ø¯Ù‡ ÙˆØ§Ù„Ù„Ù‡ ğŸ™ˆ**",
    "**ÙŠØ§ Ù…Ø³Ø§Ø¡ Ø§Ù„Ø³Ø¹Ø§Ø¯Ø© Ø¹Ù„Ù‰ Ø¹ÙŠÙˆÙ†Ùƒ ÙŠØ§ ÙÙ†Ø§Ù† â˜¹ï¸**",
    "**ÙƒÙ„Ù…Ù†ÙŠ Ø´ÙˆÙŠØ©ØŒ Ø§Ù„Ø¬Ùˆ Ù‡Ø¯ÙˆØ¡ Ø£ÙˆÙŠ Ù‡Ù†Ø§ ğŸ¥º**",
    "**Ø¹Ø§Ù…Ù„ Ø¥ÙŠÙ‡ ÙŠØ§ ÙˆØ­Ø´ ÙÙŠ ÙŠÙˆÙ…ÙƒØŸ ğŸ‘€**",
    "**Ø¥Ù†Øª Ø³Ù†Ø¬Ù„ ÙˆÙ„Ø§ Ù…Ø±ØªØ¨Ø·ØŸ Ø§Ø®Ù„Øµ ÙˆØ§Ø¹ØªØ±Ù ğŸ™‚**",
    "**Ø¶Ø­ÙƒØªÙƒ Ø¯ÙŠ Ù‡ÙŠ Ø§Ù„Ù„ÙŠ Ù…Ù‡ÙˆÙ†Ø© Ø¹Ù„ÙŠÙ†Ø§ Ø§Ù„Ø´Ø§Øª âœŒï¸**",
    "**ØªÙŠØ¬ÙŠ Ù†ÙƒÙˆÙ† Ø£ØµØ­Ø§Ø¨ Ø¨Ø¬Ø¯ØŸ ğŸ¥°**",
    "**Ù†ÙØ³ÙŠ Ø£Ø´ÙˆÙÙƒ Ø¯Ø§ÙŠÙ…Ø§ Ù…Ø¨Ø³ÙˆØ· ÙˆÙØ±Ø­Ø§Ù† ğŸ¤**",
    "**ÙŠØ§ Ù‚Ù…Ø± Ù…Ù†ÙˆØ± ÙÙŠ Ø³Ù…Ø§Ù†Ø§ØŒ Ø§Ø¸Ù‡Ø± Ø¨Ù‚Ù‰ ğŸŒ•**",
    "**Ø£Ø­Ù„Ù‰ ØªØ­ÙŠØ© Ù„ÙƒÙ„ Ø§Ù„Ù†Ø§Ø³ Ø§Ù„Ù„ÙŠ Ù‡Ù†Ø§ ğŸ«¡**",
    "**ÙŠØ§ Ø¨Ø®Øª Ø§Ù„Ø¬Ø±ÙˆØ¨ Ø¯Ù‡ Ø¨ÙŠÙƒ ÙˆØ§Ù„Ù„Ù‡ ğŸ’**",
    "**Ø®Ù„ÙŠÙƒ Ø¯Ø§ÙŠÙ…Ø§ Ù…Ù†Ø¨Ø¹ Ø·Ø§Ù‚Ø© Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© ğŸ¦‹**",
    "**Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø­Ù„ÙˆØ© Ø·Ø§Ù„Ø¹Ø© Ù…Ù† Ø§Ù„Ù‚Ù„Ø¨ Ù„Ù„Ù‚Ù„Ø¨ ğŸ’–**"
]

VC_TAG = [ 
    "**ÙŠØ§ Ø¨Ø·Ù„ ØªØ¹Ø§Ù„ Ø§Ù„ÙƒÙˆÙ„ (VC) Ù…Ø³ØªÙ†ÙŠÙ†Ùƒ ğŸ¥²**",
    "**Ø§Ø·Ù„Ø¹ Ø§Ù„ÙƒÙˆÙ„ Ø¨Ø³Ø±Ø¹Ø© Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ù…Ù‡Ù… ğŸ˜¬**",
    "**ØªØ¹Ø§Ù„ Ø§Ù„ÙƒÙˆÙ„ ÙŠØ§ Ø³ÙƒØ± Ù…Ø­ØªØ§Ø¬ÙŠÙ†Ùƒ ğŸ“**",
    "**Ù…Ù…ÙƒÙ† ØªØ·Ù„Ø¹ Ø§Ù„ÙƒÙˆÙ„ ØªÙ†ÙˆØ±Ù†Ø§ Ø´ÙˆÙŠØ©ØŸ ğŸ¥°**",
    "**ÙŠØ§ ÙˆØ­Ø´ ÙÙƒÙƒ Ù…Ù† Ø§Ù„Ø´Ø§Øª ÙˆØªØ¹Ø§Ù„ Ø¯Ø±Ø¯Ø´ ÙƒÙˆÙ„ ğŸ¤¨**",
    "**Ø§Ø³Ù…Ø¹ Ù…Ù†ÙŠ ÙˆØ§ÙØªØ­ Ø§Ù„ÙƒÙˆÙ„ Ø¯Ù„ÙˆÙ‚ØªÙŠ ğŸ¤£**",
    "**ØªØ¹Ø§Ù„ Ø§Ù„ÙƒÙˆÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¨Ø³ Ø¬Ø±Ø¨ ğŸ˜**",
    "**Ø§Ù„ÙƒÙˆÙ„ ÙˆÙ„Ø¹Ø§Ù† ÙˆÙÙŠÙ‡ Ø£Ù„Ø¹Ø§Ø¨ Ø´ØºØ§Ù„Ø© Ø¯Ù„ÙˆÙ‚ØªÙŠ âš½**",
    "**ØªØ¹Ø§Ù„ Ø§Ù„ÙƒÙˆÙ„ Ø¹Ø´Ø§Ù† Ø®Ø§Ø·Ø±ÙŠ ğŸ¥º**",
    "**ÙŠØ§ Ø¬Ù…ÙŠÙ„ Ø§Ø·Ù„Ø¹ Ø§Ù„ÙƒÙˆÙ„ Ø«ÙˆØ§Ù†ÙŠ ğŸ˜¥**",
    "**ØªØ¹Ø§Ù„ Ø§Ù„ÙƒÙˆÙ„ Ù‡ÙˆØ±ÙŠÙƒ Ø­Ø§Ø¬Ø© Ø­Ù„ÙˆØ© ğŸ™„**",
    "**Ø§ÙØªØ­ Ø§Ù„ÙƒÙˆÙ„ ÙˆØ´ÙˆÙ Ø§Ù„Ø£ØºÙ†ÙŠØ© Ø¯ÙŠ Ø´ØºØ§Ù„Ø© Ø¹Ù†Ø¯ÙƒØŸ ğŸ¤”**",
    "**ØªØ¹Ø§Ù„ Ø§Ù„ÙƒÙˆÙ„ Ù…Ø´ Ù‡ØªØ®Ø³Ø± Ø­Ø§Ø¬Ø©ØŒ Ø¬Ø±Ø¨ ğŸŒš**"
]

@app.on_message(filters.command(["tagall"], prefixes=["/", "@", ".", "#"]))
async def mentionall(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("Ø§Ù„Ø£Ù…Ø± Ø¯Ù‡ Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¨Ø³ ÙŠØ§ ÙˆØ­Ø´.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (ChatMemberStatus.ADMINISTRATOR, ChatMemberStatus.OWNER):
            is_admin = True
            
    if not is_admin:
        return await message.reply("ÙŠØ§ Ø¨ÙŠØ¨ÙŠ Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ø£Ø¯Ù…Ù† Ø¹Ø´Ø§Ù† ØªÙ†Ø§Ø¯ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§Ø³.")

    if message.reply_to_message and message.text:
        return await message.reply("Ø§ÙƒØªØ¨ /tagall Ø£Ùˆ Ø±Ø¯ Ø¹Ù„Ù‰ Ø£ÙŠ Ø±Ø³Ø§Ù„Ø© Ø¹Ø´Ø§Ù† Ø£Ø¨Ø¯Ø£.")
    elif message.text:
        mode = "text_on_cmd"
        msg = message.text
    elif message.reply_to_message:
        mode = "text_on_reply"
        msg = message.reply_to_message
        if not msg:
            return await message.reply("Ø±Ø¯ Ø¹Ù„Ù‰ Ø±Ø³Ø§Ù„Ø© Ø¹Ø´Ø§Ù† Ø£Ø¨Ø¯Ø£ Ø£Ù†Ø§Ø¯ÙŠ Ù„Ù„ÙƒÙ„...")
    else:
        return await message.reply("Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ù…Ø± ØµØ­ ÙŠØ§ Ù†Ø¬Ù….")

    if chat_id in spam_chats:
        return await message.reply("ÙÙŠÙ‡ Ø¹Ù…Ù„ÙŠØ© Ù…Ù†Ø´Ù† Ø´ØºØ§Ù„Ø© ÙØ¹Ù„Ø§Ù‹ØŒ ÙˆÙ‚ÙÙ‡Ø§ Ø§Ù„Ø£ÙˆÙ„.")
        
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += "<a href='tg://user?id={}'>{}</a>".format(usr.user.id, usr.user.first_name)

        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(TAGMES)}\n\nÖ¼Ø¨Ù€Ù°ï¯¡Ø¯ÙØ§ ×€ ğ—¦ğ—¢ğ—¨ğ—¥ğ—–ğ—˜ ğ—•ğ—¢ğ——ğ—” ğŸ‘£"
                await client.send_message(chat_id, txt)
            elif mode == "text_on_reply":
                await msg.reply(f"[{random.choice(EMOJI)}](tg://user?id={usr.user.id})")
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
            
    try:
        spam_chats.remove(chat_id)
    except:
        pass

@app.on_message(filters.command(["tagoff", "tagstop"]))
async def cancel_spam(client, message):
    if not message.chat.id in spam_chats:
        return await message.reply("Ù…ÙÙŠØ´ Ù…Ù†Ø´Ù† Ø´ØºØ§Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙŠØ§ ÙÙ†Ø§Ù†.")
        
    is_admin = False
    try:
        participant = await client.get_chat_member(message.chat.id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (ChatMemberStatus.ADMINISTRATOR, ChatMemberStatus.OWNER):
            is_admin = True
            
    if not is_admin:
        return await message.reply("Ø£Ù…Ø± Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ù„Ù„Ø£Ø¯Ù…Ù† Ø¨Ø³ ÙŠØ§ Ø¬Ù…ÙŠÙ„.")
    else:
        try:
            spam_chats.remove(message.chat.id)
        except:
            pass
        return await message.reply("ğŸŒ· ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ù…Ù†Ø´Ù† Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø¨Ù†Ø¬Ø§Ø­.\n\nÖ¼Ø¨Ù€Ù°ï¯¡Ø¯ÙØ§ ×€ ğ—¦ğ—¢ğ—¨ğ—¥ğ—–ğ—˜ ğ—•ğ—¢ğ——ğ—” ğŸ‰")
